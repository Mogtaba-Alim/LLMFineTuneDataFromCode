{
  "repo": "research_papers",
  "file": "Reusability_report:_Evaluating_reproducibility_and_reusability_of_a_finetuned_model_to_predict_drug_response_in_cancer_patient_samples.pdf",
  "language": "research_paper",
  "content": "Nature Machine Intelligence | Volume 5 | July 2023 | 792798 792 nature machine intelligence Articlehttps, //doi.org/10.1038/s42256-023-00688-4 Reusability report, Evaluating reproducibility and reusability of a fine- tuned model to predict drug response in cancer patient samples Emily So1, 2,  Fengqing Yu 1, 2,  Bo Wang 1, 2, 3, 4 & Benjamin Haibe-Kains 1, 2, 3, 4, 5, 6 Machine learning and artificial intelligence methods are increasingly being used in personalized medicine, including precision oncology., Ma et al. (Nature Cancer 2021) have developed a new method called transfer of cell line response prediction (TCRP) to train predictors of drug response in cancer cell lines and optimize their performance in higher complex cancer model systems via few-shot learning., TCRP has been presented as a successful modelling approach in multiple case studies. Given the importance of this approach for assisting clinicians in their treatment decision processes, we sought to independently reproduce the authors findings and improve the reusability of TCRP in new case studies, including validation in clinical-trial datasetsa high bar for drug-response prediction., Our reproducibility results while not reaching the same level of superiority as those of the original authors, were able to confirm the superiority of TCRP in the original clinical context., Our reusability results indicate that in the majority of novel clinical contexts, TCRP remains the superior method for predicting response for both preclinical and clinical settings., Our results thus support the superiority of TCRP over established statistical and machine learning approaches in preclinical and clinical settings., We also developed new resources to increase the reusability of the TCRP model for future improvements and validation studies., With recent advances in molecular profiling and computational technologies there has been increasing interest in developing and using machine learning (ML) and artificial intelligence (AI) methods for personalized medicine and precision oncology., One active area of research focuses on computational models capable of predicting the therapy response in patients with cancer., Given the challenges present in obtaining a compendium of clinical genomic data that is sufficiently large for multivariable analysis, the majority of studies train drug-response predictors on large-scale preclinical pharmacogenomic data and assess the performance of the resulting predictive models using limited patient data., Preclinical models however, do not always faithfully recapitulate the therapy response observed in patients., Possible underlying reasons for this limitation include the lack of tumour microenvironment components in cell lines and the clear differences in the evolutionary pressures in human physiological environments and cell cultures1., Translating predictors trained on preclinical data to achieve good accuracy on clinical data remains an open challenge., If the translation is successful these predictors hold Received,  28 February 2023 Accepted, 9 June 2023 Published online,  10 July 2023 Check for updates 1Princess Margaret Cancer Centre, University Health Network,  Toronto,  Canada., 2Medical Biophysics, University of Toronto, Toronto, Canada. 3Vector Institute for Artificial Intelligence, Toronto, Canada. 4Department of Computer Science, University of Toronto, Toronto, Canada. 5Ontario Institute for Cancer Research, Toronto, Canada. 6Department of Biostatistics, Dalla Lana School of Public Health, Toronto, Canada. e-mail benjamin.haibe-kains@uhn.ca Nature Machine Intelligence | Volume 5 | July 2023 | 792798 793 Article https, //doi.org/10.1038/s42256-023-00688-4and predict response in more complex in vitro patient-derived cell cultures and in vivo patient-derived xenografts., Given the impressive nature of the original papers results this Reusability Report aims to address two issues, (1) confirming the performance of the TCRP model in its published context and (2) expanding its application on a larger compendium of preclinical pharmacogenomic and clinical-trial data., Following successful testing and deployment modelling approaches great potential for improving the selection of anticancer therapies, a key challenge in precision oncology., In a recent paper in Nature Cancer, Ma et al. introduced transfer of cell line response prediction (TCRP)2 a new method for transferring drug response prediction based on few-shot learning., The authors showed that their approach enabled the development of computa- tional models able to learn from immortalized cancer cell-line data 0.40.4 0.3 0.2 0.1 0 0.1 0.2 1 2 3 4 5 6 7 8 9 100.3 0.2 0.1 0 0.1 0.2 KU-55933 Sorafenib CHIR-99021 Axitinib BMS-536924 GSK1904529A AICARKU-55933 Sorafenib CHIR-99021 Axitinib BMS-536924 GSK1904529A AICAR FK866 AZ628 BMS-754807 JQ1 MK-2206 PAC-1 GDC0941 PD-0332991 JNK_inhibitor_VIIIFK866 AZ628 BMS-754807 JQ1 MK-2206 PAC-1 GDC0941 PD-0332991 JNK_inhibitor_VIII Nilotinib AZD6482 AZD8055 BX-795 PF-562271 YK_4279 LY317615 ZM-447439 PLX4720 NU-7441 PD-0325901 Embelin Obatoclax_mesylate SL_0101-1 PD-173074 AMG-706 GSK269962A AZD7762 AG-014699 Camptothecin BI-2536 JNJ-26854165 SB_216763 Bosutinib Gefitinib GW_441756 PF-4708671 Vorinostat Tamoxifen CEP-701 681640 RO-3306 TW_375Z-7-oxozeaenolSL_0101-1 PD-173074 AMG-706 GSK269962A AZD7762 AG-014699 Camptothecin BI-2536 JNJ-26854165 SB_216763 Bosutinib Gefitinib GW_441756 PF-4708671 Vorinostat Tamoxifen CEP-701 681640 RO-3306 TW_375Z-7-oxozeaenol1 0.5 0.3 0.1 0.1 Correlation (predicted, actual) Correlation (predicted, actual) Difference in correlation values0.3 0.5 TCRP Random forestRandom forest Published ReimplementedBetter performance for Neural network Nearest neighbour Linear regression0.5 0.1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.3 0.1 0.1 0.3 0.5 0.7Pretrained in cell linesPretrained in cell lines2 3 4 5 Number of PDTC models Number of PDTC models6 7 8 9 10Correlation (predicted, actual) Correlation (predicted, actual) Nilotinib AZD6482 AZD8055 BX-795 PF-562271 YK_4279 LY317615 ZM-447439 PLX4720 NU-7441 PD-0325901 Embelin Obatoclax_mesylateKU-55933 Sorafenib CHIR-99021 Axitinib BMS-536924 GSK1904529A AICAR FK866 AZ628 BMS-754807 JQ1 MK-2206 PAC-1 GDC0941 PD-0332991 JNK_inhibitor_VIII SL_0101-1 PD-173074 AMG-706 GSK269962A AZD7762 AG-014699 Camptothecin BI-2536 JNJ-26854165 SB_216763 Bosutinib Gefitinib GW_441756 PF-4708671 Vorinostat Tamoxifen CEP-701 681640 RO-3306 TW_375Z-7-oxozeaenolNilotinib AZD6482 AZD8055 BX-795 PF-562271 YK_4-279 LY317615 ZM-447439 PLX4720 NU-7441 PD-0325901 Embelin Obatoclax_mesylateTCRPMethods aNeural network Nearest neighbour Linear regression b c d e Fig., 1 | Reproducibility attempt for Challenge #2 from the original paper by Ma et al. a, The original published results of Challenge 2. The results show that across 50 priority drugs, the TCRP model had higher Pearsons correlation than baseline methods in predicting drug response in PDTCs when trained on GDSC1 cell lines., The error bars indicate mean performance across all drugs  95% confidence interval (CI). b , Our reproducibility attempt using resources and code provided in the original publication. The plot demonstrates that we were not able to reproduce the same objective value as the published TCRP performance, but were able to prove that it performs better than baselines., c  Dot plot depicting the original plot of published TCRP versus baseline performance, separated by drug., d, Dot plot depicting our reimplementations TCRP versus baseline performance, separated by drug. Once again there were differences in objective values of TCRP between our reimplementation and the original publication, but the overall TCRP performance is better than the baselines., e Bidirectional plot showing the difference between the published objective value and the implementation objective value., Red bars (positive difference) indicate that the published model performed better for a drugs prediction and blue bars (negative difference) that the reimplemented model performed better for a drugs prediction., Nature Machine Intelligence | Volume 5 | July 2023 | 792798 794 Article https //doi.org/10.1038/s42256-023-00688-4such as TCRP will help improve personalized medicine by facilitating the matching of a patients molecular profile to optimal therapy., Reproducibility We first aimed to fully reproduce the results outlined in the original publication training drug response predictors using the GDSC13 immortalized cancer cell-line dataset and test its predictive value in patient-derived breast tumour cells (PDTCs)4., This task was called Chal - lenge #2 in the original publication and was split into four stages (1) extracting gene expression and drug-response features from the data - set (GDSC1), (2) training the model-agnostic meta-learning (MAML) algorithm to predict the drug response in cell lines, as well as hyperpa - rameter tuning, (3) fine-tuning these models using a small subset of the PDTC dataset using few-shot learning, (4) validation on the remaining PDTC samples., The authors shared the links to the GDSC1 and PDTC datasets, which are both publicly available. Their computer code was shared via two GitHub repositories original codebase and tcrp-reproduce (both provided by the original authors)., In the original codebase a download link for the TCRP model is provided, with one line com - mand to run the model on a single drug,  sorafenib., However, there is no instruction on model training or hyperparameter tuning on other drugs. In the tcrp-reproduce repository there are instructions for TCRP model training and baseline comparison to established pre - dictive modelling approaches, but the instructions are incomplete., The software versions and dependencies are also listed. In stage (1) we could only extract the input features (cell lines expression and mutational profiles, drug response values) for 32 out of 50 priority drugs investigated in the original publication due to missing reference files., Possible causes of this issue are discussed in the Methods. In stage (2) we were unable to reproduce the deep neural network (MAML) results exactly due to the missing drugs from stage (1), and the performance comparison was incomplete due to the lack of code for the baseline models implementation., Of the four baseline models only code for random forest, linear regression and k-nearest neighbours was provided by the authors., The neural network was described as a simplified version of the TCRP model and the architecture was not provided in the baseline code., Consequently we had to reimplement the training and testing procedure of this important baseline model., In stage (3) the hyperparameters for the fine-tuning process were not released with the original publication, forcing us to conduct a brute-force search to test all possible combinations of values listed by the authors to find the best-performing set of parameters for each drugtissue combination., Although the original authors provided methods for configuring the tuning for a subset of hyperparameters, we were still unable to achieve the exact objective values published, most probably due to hyperparameter configurations we did not explore during cross-validation (Fig., 1 ). In stage (4) the authors showed that their TCRP model outper - formed established statistical (linear regression) and ML models (nearest-neighbour, random forest and neural network) on the set of 50 priority drugs on the PDTC dataset (Fig., 1a). Using our reimplemented TCRP model we were able to confirm the superiority of the TCRP model on average (Fig., 1b ). We did not achieve the same level of predictive value however, with a Pearson correlation between predictions and measured drug response of over 0.3 in the original publication, whereas the reimplemented model only reached a peak predictive value of 0.2 (Fig., 1b ). We also observed better predictive value for the simple linear regression model in our reanalysis which reached a positive Pearson correlation,  contrary to the published results (Fig., 1b). At the drug level there were consistent differences in our correlation values in comparison to the original publication (Fig., 1c,d). We observed the biggest differences for the drugs sorafenib and MK-2206. This could be due to the lack of features for extraction (common genes between reference and transfer datasets), inconsistent names in drug targets or errors in the hyperparameter tuning (Fig., 1e). In the original publication the authors also included,  as a supple- mentary image, the performance of the TCRP method in comparison to baseline methods using Spearman correlation instead of Pearson correlation (Fig., 2a). When performing the same experiment using our reproducibility attempt, we achieved similar results. Although mini - mal the Spearman correlation of TCRP performance was on average 0.010.04 lower than the Pearson correlation across the number of samples (Fig., 2b). Although this is an interesting comparison to include in our reproducibility attempt in previous comparisons of Pearson versus Spearman correlations, the former has proven to be the more powerful statistic5 and therefore the results using that metric can take precedence in this context., Overall we were able to reimplement the TCRP model and to con - firm its superiority compared to established statistical and ML models using the same training (GDSC1) and validation (PDTC) datasets., Reusability To assess whether the TCRP model can be applied to preclinical and clinical datasets that were not explored in the original publication, 0.4aTCRPMethods Random forest Neural network Linear regression Nearest neighbour 0.3 0.2 0.1 0 0.1 0.2 0.4 0.3 0.2 0.1 0 0.1 0.21 Pretraining in cell lines2 3 Number of PDTC models4 5 6 7 8 910 1 Pretraining in cell lines2 3 Number of PDTC models4 5 6 7 8 9 10Correlation (predicted, actual)Correlation (predicted,  actual) b Fig., 2 | Equivalent performance calculations on TCRP and baseline methods using Spearmans correlation as previously done in the original paper by Ma et al., a, Original supplemental results using Spearman correlation for performance calculations. The results show that although Spearmans correlation was consistently lower than the reported Pearsons correlation, the TCRP model remained superior to baseline methods in predicting drug response in PDTCs when trained on GDSC1 cell lines., b , Performance calculation using Spearmans correlation of our reproducibility attempt. We observed the same trend in performance calculation as the original authors. Using the 32 priority drugs for which we were able to obtain features the results show that the TCRP model was also superior to baseline methods, with Spearman correlation values on average 0.010.04 lower than the Pearson correlation across the number of samples., Nature Machine Intelligence | Volume 5 | July 2023 | 792798 795 Article https //doi.org/10.1038/s42256-023-00688-4we first investigated its performance when trained on different cell-line datasets available on our ORCESTRA platform6, namely the CTRP7,  gCSI8 and GDSC29 datasets., During the training process for each dataset we again tuned the hyperparameter of the model for each drug., We observed that for drugs shared among the different training sets, the hyperparameters used for optimal TCRP performance on one dataset cannot seamlessly be used for another (Supplementary Information)., Retuning hyperparameters for the TCRP model must occur any time a new dataset (reference or validation) is introduced, or when different sets of drugs are used to extract features., The newly trained TCRP mod - els still outperformed the baseline predictive models irrespective of the training set used (Fig., 3 ), confirming the robustness of the approach with respect to cell-line data. TCRP was the only model that was consist - ently the best across training datasets. Interestingly for the only drug common to all cell-line datasetspaclitaxelwe observed that training TCRP on the CTRPv2 dataset achieved lower predictive value on PDTC than the reference datasets (Pearson correlations of 0.48, 0.45 and 0.15 for the gCSI-,  GDSC2- and CTRPv2-trained TCRP models,  respec- tively), suggesting that the choice of training data may be important for developing the best drug-response predictors., Independently of TCRP performance when evaluating performance on new reference datasets, we observed that the performance of baseline methods varied 0.3a 0.3 0.2 0.1 0 0.10.2 0.1 0.6 0.4 0.2 0 0.2 0.4 0.6 0.8 1 2 3 4 5 6 7 8 9 100 0.1 Pretrained PretrainedPretrained 1 1 2 3 4 5 6 7 8 9 10 2 3 4 5 Number of samplesGDSC2 PDTC resultsLinear regression Random forest TCRPNeural network Nearest neighbour CTRP PDTC results gCSI PDTC resultsNumber of samples Number of samples6 7 8 9 10Correlation (predicted, actual) Correlation (predicted,  actual) Correlation (predicted, actual)b c Linear regression Random forest TCRPNeural network Nearest neighbour Linear regression Random forest TCRPNeural network Nearest neighbour Fig., 3 | Performance of TCRP versus common baselines on new reference datasets. For each new reference dataset instead of using the original 50 priority drugs, any drugs with a sufficient number of cell-line response values that were also present in the PDTC data were used., The drug sets are different across all three datasets. a  Performance of TCRP versus other baselines on predicting drug response in PDTCs, trained on GDSC2., b  Performance of TCRP versus other baselines on predicting drug response in PDTCs, trained on CTRPv2., c, Performance of TCRP versus other baselines on predicting drug response in PDTCs, trained on gCSI. Nature Machine Intelligence | Volume 5 | July 2023 | 792798 796 Article https //doi.org/10.1038/s42256-023-00688-4greatly., Possible factors related to this observation could be the dif - ferences in study design such as sample normalization or the size of the reference training dataset., It could also be related to the authors code design such as the neural network performance being affected by the missing original implementation., To further challenge the reusability of the TCRP approach we assessed the predictive value of the TCRP model on datasets that are representative of diverse preclinical and clinical scenarios., Using GDSC1 as the training set we tested the transfer of predictors for response to paclitaxel in breast cancer on (1) immortalized cell lines (UHNBreast10, 11), (2) patient-derived xenografts (Novartis PDX Ency - clopedia12) and (3) two clinical trials (GSE250661315 and GSE4199816)., This was challenging due to the fact that the drug response was assessed differently in each setting., For in vitro models such as immortalized cancer cell lines or patient-derived tumour cell cultures, the drug response is measured via drug doseresponse curves., For in vivo mod - els such as patient-derived xenografts, the drug response is measured via tumour-growth curves., In clinical trials drug responses are evalu-ated using the Response Evaluation Criteria in Solid Tumors (RECIST) measure17, categorizing the tumour response as complete response (CR),  partial response (PR), stable disease (SD) or progressive disease (PD)., To achieve alignment between these different drug response read - outs it is possible to map all drug responses to categorical variables., For example, Gao et al. introduce the modified RECIST (mRECIST) cri - terion to map tumour-growth curves to the RECIST categories used in clinical trials12., We18 and others19 have investigated ways to dichotomize 0.20a b c dGDSC1 UHNBreast results GDSC1 GSE25066 results GDSC1 GSE41998 resultsGDSC1 PDX_Breast results 0.3 0.2 0.1 0 0.10.15 0.10 0.05 0.05 0.25 0.10 0.05 0.05 0.10 0.1500.20 0.15 0.10 0.05 0 0.050Correlation (predicted, actual)Correlation (predicted,  actual) Correlation (predicted,  actual)Correlation (predicted, actual) Pretrained 1 2 3 4 5 Number of samples6 7 8 9 10 Pretrained 1 2 3 4 5 Number of samples6 7 8 9 10 Pretrained 1 2 3 4 5 Number of samples6 7 8 9 10Pretrained 1 2 3 4 5 Number of samples6 7 8 9 10Linear regression Random forest TCRPNeural network Nearest neighbour Linear regression Random forest TCRPNeural network Nearest neighbour Linear regression Random forest TCRPNeural network Nearest neighbour Linear regression Random forest TCRPNeural network Nearest neighbour Fig., 4 | Performance of TCRP versus other baselines in three new validation contexts. ad Performance was evaluated using only the drug response from paclitaxel on all four datasets, and all four models were trained on GDSC1, TCRP performance versus baselines on predicting the drug response on a new dataset of immortalized breast cancer cell lines (UHNBreast) (a ), TCRP performance versus baselines on predicting the drug response on breast cancer patient- derived xenografts models treated with paclitaxel (Novartis PDX Encyclopedia) (b), TCRP performance versus baselines on predicting the drug response on two clinical trials (c , d)., Nature Machine Intelligence | Volume 5 | July 2023 | 792798 797 Article https //doi.org/10.1038/s42256-023-00688-4the drug response from doseresponse curves in cell lines., To trans - fer drug-response prediction across the in vitro in vivo and clinical settings, we binarized the drug-response readout as responders (R) versus non-responders (NR)., Specifically, we grouped CR and PR as R, and SD and PD as NR. In cell lines we enforce a threshold cutoff on the area above the dose response curve (AAC) 18, with AAC > 0.2 classified as R,  and AAC  0.2 as NR., On training and validating TCRP in this new analysis frame - work we observed that the TCRP model showed an overall better performance than baseline models in most settings, including the two clinical trials (Fig., 4 ). Notably the TCRP model failed to outper - form the nearest-neighbour modelling approach in the UHNBreast cell-line dataset (Fig., 4a) while outperforming all other methods in the more complex patient-derived xenograft and clinical-trial datasets (Fig., 4bd ). Altogether our reusability study strongly supports the capacity of the TCRP modelling approach to transfer its predictive value by learning from a few samples generated in a new context., Our results show that TCRP can learn the complex relationship between molecular features of cancer cells and their drug response using large cell lines pharmacogenomic datasets, and fine-tune the resulting predictors to achieve higher performance in more complex preclinical models or in clinical trials., Discussion In the course of reproducing and reusing the TCRP models some per-sistent challenges were encountered., The primary issue is the limited number of drugs that we could recover from the reference datasets. On utilizing the same datasets as employed in the original paper only 32 out of 50 drugs were successfully recovered., Furthermore on reap - plying the model to alternative reference datasets (that is, baseline cell-line drug-screening studies), there was a substantial reduction in the number of drugs that the model was able to predict due to the smaller number of drugs commonly investigated., One of the larger issues we faced in the reproducibility process was tuning the TCRP model for increased performance., The hyper - parameters including the number of few-shot samples and learning rate, must be uniquely adjusted for each specific drug and validation dataset combination., However this process appeared to be worthwhile,  as it appeared that,  with tuning, the TCRP model performed well in various contexts for reusability., There was consistent success in our experiments in predicting response in both cell-line patient-derived cancer models and clinical datasets., Corroborating the original publication our results support the TCRP model as a successful approach for predicting clinical drug response., However there are additional measures that can be taken to ensure the full reproducibility and reusability of the TCRP approach., Direct replication of a published model through code clon - ing and reimplementation can be a time-intensive and error-prone process due to factors such as changes in path and directory and software environment requirements., It is thus critical to ensure that the model is implemented in a manner that is easily shareable and executable20., To this end all our experiments were conducted using a Code Ocean capsule, which offers an end-to-end workflow for the model and enables straightforward sharing and execution by other researchers21., Additionally proper preprocessing of the data is crucial for the models application to other datasets., Our reference and testing datasets were sourced from ORCESTRA which provides a curated dataset with detailed versioning and a unique digital object identifier (DOI), ensuring full transparency and reproducibility of dataset-processing and subsequent analysis6., Through the integra- tion and automation of the model construction process with data querying and processing, computational models such as TCRP can be readily evaluated and utilized by researchers, facilitating a greater impact of AI in medicine.Our reproducibility and reusability study further cements the published few-shot learning model as a ML approach that could be applied to different contexts, including both cell-line and clinical-trial datasets., The success of TCRP in the clinical context suggests the great potential of this approach to improve precision oncology., In addition to introducing new contexts there are improvements that can be made to the availability of this method for the scientific community., Methods such as the few-shot model can be presented in a containerized fashion either in a Python package or in an interactive containerized repository on platforms such as Code Ocean., Methods Reproducibility of the original results Stage (1), extracting drug-response data. The TCRP model first needs to be trained on large cell-line data or the reference dataset, before transfer learning on PDTCs., In the data processing, we needed to find the drug features common to the two datasets. Although we obtained the datasets using the provided link after running the code for data processing we only obtained the features for 32 out of 50 drugs in the original paper., Further investigation showed that this was caused by inconsistencies among the names of genes at which the drugs were targeted., For example CDKs were not matched with CDK9 and CDK8 , and the drug with mappable targets CDKs was thus lost., The original authors may have reconciled the differences but there is no clear indi - cation on where and how they implemented this., It would be helpful if there were reference files or instructions to convert between names and resolve the inconsistencies., Otherwise, manual tracing of each drug and gene name is required to recover more drugs. When running the TCRP model on other datasets the number of drugs that can be predicted was reduced., Upon further investigation we discovered that the assignment and distribution of training and test - ing samples was suboptimal, leading to instances where only a single testing sample was available., To ensure the accurate calculation of cor - relation coefficients we manually removed drugs with only one sample., Stage (2), MAML. The implementation of the baseline model was absent from the pipeline. As the authors did not explicitly define the architecture for the convolutional neural network (CNN) model, we had to implement it ourselves., We decided to follow the implementation of the MAML model architecture using one linear layer, a ReLU activation layer and a batch normalization layer., Stage (3), fine-tuning via few-shot learning. The hyperparameters used for the fine-tuning process are as follows Tissue number evolved in the inner update,  (6,  12, 20)  Meta learning rate and inner learning rate,  (0.1,  0.01,  0.001)  Number of hidden neurons, (5,  10,  15,  20)  Number of layers,  (1, 2) For every drug we trained the model using every possible combina - tion of the hyperparameters with their values listed above., The hyper - parameter set with the highest correlation was chosen for the specific drug model. This is costly in terms of computation as a brute-force optimization method was done for each drug and each tissue, and for each time we trained on a new dataset., Stage (4), validation on independent data . With the selected hyper - parameters from stage (3) we ran the drug-specific model and made a comparison with the original publication., We listed the drugs in the sequence of their predictive values, as in the original publica - tion. The trend of the predictiveness of the drugs we identified mostly aligned with the original publication., The top predictive drugs were KU-55933 and CHIR-99021. However there were some drugs,  such as Sorafenib and MK-2206, that had surprisingly low correlation values Nature Machine Intelligence | Volume 5 | July 2023 | 792798 798 Article https, //doi.org/10.1038/s42256-023-00688-4in our reimplementation, despite having substantially higher values in the original publication., Data availability All datasets used in our study are available on the data platform ORCES - TRA under dataset names GDSC_2020(v1-8.2),  GDSC_2020(v2-8.2),  gCSI_2019 ,  CTRPv2_2015 ,  PDTX_2019 , PDXE,  UHNBreast_2019 ,  scRNA_ GSE25066_Breast and scRNA_GSE41998_Breast., Code availability The code to run and visualize the exact results of our reproducibility attempt as well as all our novel analyses for reusability are available in the corresponding Code Ocean capsule (Version 2.5)22., Code used for the analysis is available at github.com/bhklab/TCRP_Reusability_Report. References 1. Trastulla, L., Noorbakhsh, J., Vazquez, F., McFarland, J. & Iorio, F. Computational estimation of quality and clinical relevance of cancer cell lines. Mol. Syst. Biol. 18, e11017 (2022). 2. Ma, J. et al. Few-shot learning creates predictive models of drug response that translate from high-throughput screens to individual patients., Nat. Cancer 2, 233244 (2021). 3. Yang, W. et al. Genomics of Drug Sensitivity in Cancer (GDSC) a resource for therapeutic biomarker discovery in cancer cells., Nucleic Acids Res. 41, D955D961 (2013). 4. Bruna, A. et al. A biobank of breast cancer explants with preserved intra-tumor heterogeneity to screen anticancer compounds., Cell 167, 260274 (2016). 5. Smirnov, P. et al. Evaluation of statistical approaches for association testing in noisy drug screening data. BMC Bioinf. 23, 188 (2022). 6. Mammoliti, A. et al. Orchestrating and sharing large multimodal data for transparent and reproducible research. Nat. Commun. 12, 5797 (2021). 7. Seashore-Ludlow, B. et al. Harnessing coynnectivity in a large-scale small-molecule sensitivity dataset. Cancer Discov 5, 12101223 (2015). 8. Haverty, P. M. et al. Reproducible pharmacogenomic profiling of cancer cell line panels. Nature 533, 333337 (2016). 9. Iorio, F. et al. A landscape of pharmacogenomic interactions in cancer. Cell 166, 740754 (2016). 10. Safikhani, Z. et al. Gene isoforms as expression-based biomarkers predictive of drug response in vitro. Nat. Commun. 8, 1126 (2017). 11. Thu, K. L. et al. Disruption of the anaphase-promoting complex confers resistance to TTK inhibitors in triple-negative breast cancer., Proc. Natl Acad. Sci. USA 115, E1570E1577 (2018). 12. Gao, H. et al. High-throughput screening using patient-derived tumor xenografts to predict clinical trial drug response., Nat. Med. 21, 13181325 (2015). 13. Hatzis, C. et al. A genomic predictor of response and survival following taxane-anthracycline chemotherapy for invasive breast cancer., JAMA 305, 18731881 (2011). 14. Itoh, M. et al. Estrogen receptor (ER) mRNA expression and molecular subtype distribution in ER-negative/progesterone receptor-positive breast cancers., Breast Cancer Res. Treat. 143, 403409 (2014). 15. Baldasici, O. et al. Circulating small EVs miRNAs as predictors of pathological response to neo-adjuvant therapy in breast cancer patients., Int. J. Mol. Sci. 23, 12625 (2022). 16. Horak, C. E. et al. Biomarker analysis of neoadjuvant doxorubicin/cyclophosphamide followed by ixabepilone or Paclitaxel in early-stage breast cancer., Clin. Cancer Res. 19, 15871595 (2013).17. RECIST 1.1 (EORTC); https://recist.eortc.org/recist-1-1-2/ 18. Safikhani, Z. et al. Revisiting inconsistency in large pharmacogenomic studies. F1000Res. 5, 2333 (2016). 19. Barretina, J. et al. The Cancer Cell Line Encyclopedia enables predictive modelling of anticancer drug sensitivity. Nature 483, 603607 (2012). 20. Raff, E. Research reproducibility as a survival analysis. In Proc. AAAI Conference on Artificial Intelligence Vol. 35, 469478 (AAAI, 2021). 21. Clyburne-Sherin, A., Fei, X. & Green, S. A. Computational reproducibility via containers in psychology. Meta-Psychology https://doi.org/10.15626/MP.2018.892 (2019). 22. Reusability Report Few-shot learning creates predictive models of drug response that translate from high-throughput screens to individual patients (Version 2.5) (Code Ocean), https, //codeocean.com/capsule/8411716/tree/v2 Acknowledgements This work was supported by Canadian Cancer Society Data Transformations (707609) and by a Natural Sciences and Engineering Research Council of Canada Discovery Grant (RGPIN-2021-02680)., Author contributions E.S. and F.Y. conducted the reproducibility and reusability experiments curated datasets, drafted the first version of the manuscript and integrated all the edits., B.W. supervised the manuscript. B.H.-K. contributed ideas and supervised the manuscript writing and final edits. Competing interests B.H.K. is a shareholder and paid consultant for Code Ocean Inc. E.S. is a paid consultant for Code Ocean Inc. The remaining authors declare no competing interests. Additional information Supplementary information The online version contains supplementary material available at https, //doi.org/10.1038/s42256-023-00688-4 ., Correspondence and requests for materials should be addressed to Benjamin Haibe-Kains. Peer review information Nature Machine Intelligence thanks Bo Yuan and the other anonymous, reviewer(s) for their contribution to the peer review of this work., Reprints and permissions information is available at www.nature.com/reprints.Publishers note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.Springer Nature or its licensor (e.g., a society or other partner) holds exclusive rights to this article under a publishing agreement with the author(s) or other rightsholder(s), author self-archiving of the accepted manuscript version of this article is solely governed by the terms of such publishing agreement and applicable law., The Author(s), under exclusive licence to Springer Nature Limited 2023",
  "qa_pairs": [
    {
      "question": "What is the main objective of the research in this paper?",
      "answer": "The main objective of the research in this paper is to independently reproduce the findings of the transfer of cell line response prediction (TCRP) model developed by Ma et al. and to improve its reusability in predicting drug response across various clinical contexts. The authors aimed to confirm the performance of the TCRP model in its original context and to expand its application to a broader range of preclinical and clinical datasets, thereby supporting its potential utility in personalized medicine and precision oncology."
    },
    {
      "question": "Can you summarize the abstract of the paper?",
      "answer": "The abstract of the paper discusses the evaluation of the reproducibility and reusability of the Transfer of Cell Line Response Prediction (TCRP) model, which is used for predicting drug responses in cancer patients. The authors aimed to independently reproduce the findings of a previous study that demonstrated TCRP's effectiveness in predicting drug responses using few-shot learning. While their results confirmed TCRP's superiority in the original clinical context, they did not achieve the same level of predictive performance as the original authors. However, TCRP remained the superior method for predicting drug responses across various new clinical contexts. The study highlights the importance of TCRP in precision oncology and emphasizes the need for improved resources to enhance the model's reusability for future studies. Overall, the findings support TCRP's potential in personalized medicine by effectively matching patients' molecular profiles to optimal therapies."
    },
    {
      "question": "What are the softwares and computational tools that were used in this paper?",
      "answer": "The research paper mentions the use of several software and computational tools, including:\n\n1. **MAML (Model-Agnostic Meta-Learning)** - This algorithm was used for training drug response predictors.\n2. **Random Forest** - One of the baseline models implemented for comparison.\n3. **Linear Regression** - Another baseline model used in the study.\n4. **K-Nearest Neighbors** - Also a baseline model included in the analysis.\n5. **Neural Network** - A simplified version of the TCRP model was implemented, although its architecture was not provided in the original code.\n6. **Code Ocean** - The experiments were conducted using Code Ocean capsules, which provide an end-to-end workflow for model sharing and execution.\n7. **GitHub Repositories** - The original codebase and a repository named `tcrp-reproduce` were utilized for accessing the TCRP model and its training instructions.\n\nAdditionally, the paper emphasizes the importance of proper software environment management and data preprocessing for reproducibility and reusability of the computational models."
    },
    {
      "question": "Describe the methodology used in the paper.",
      "answer": "The methodology used in the paper involves a systematic approach to evaluate the reproducibility and reusability of the Transfer of Cell Line Response Prediction (TCRP) model for predicting drug response in cancer patient samples. The methodology can be broken down into several key stages:\n\n1. **Reproducibility Attempt**: The authors aimed to reproduce the results of the original TCRP model as described by Ma et al. (2021). This process was divided into four stages:\n   - **Stage 1: Data Extraction**: The authors extracted gene expression and drug-response features from the GDSC1 dataset, but could only obtain features for 32 out of 50 drugs due to missing reference files and inconsistencies in gene names.\n   - **Stage 2: Model Training**: They implemented the model-agnostic meta-learning (MAML) algorithm to train the drug response predictors. However, they faced challenges in reproducing the deep neural network results due to the absence of baseline model architecture details.\n   - **Stage 3: Fine-Tuning**: The authors fine-tuned the models using few-shot learning, conducting a brute-force search for hyperparameter optimization across various combinations to identify the best-performing parameters for each drug-tissue combination.\n   - **Stage 4: Validation**: The final stage involved validating the model on independent patient-derived tumor cell (PDTC) samples and comparing the results with the original publication.\n\n2. **Reusability Assessment**: To evaluate the TCRP model's applicability to new clinical contexts, the authors tested the model on various datasets, including CTRP, gCSI, and GDSC2. They tuned hyperparameters for each dataset and assessed the model's performance across different preclinical and clinical scenarios, including patient-derived xenografts and clinical trials.\n\n3. **Performance Evaluation**: The authors compared the TCRP model's performance against established statistical and machine learning models (e.g., linear regression, random forest, nearest neighbor) using metrics such as Pearson and Spearman correlation coefficients. They also addressed the challenges of aligning different drug response measurements across various experimental settings.\n\n4. **Data and Code Availability**: The authors ensured transparency by making all datasets and code used in their study publicly available, facilitating reproducibility and further research.\n\nOverall, the methodology emphasizes a rigorous approach to validating and enhancing the TCRP model's predictive capabilities in diverse cancer treatment contexts, while also addressing the challenges of reproducibility in computational modeling."
    },
    {
      "question": "What are the key findings of the paper?",
      "answer": "The key findings of the paper titled \"Evaluating reproducibility and reusability of a fine-tuned model to predict drug response in cancer patient samples\" are as follows:\n\n1. **Reproducibility of TCRP Model**: The authors attempted to reproduce the results of the Transfer of Cell Line Response Prediction (TCRP) model originally developed by Ma et al. They confirmed that while they could not achieve the same level of predictive performance as the original study, they were able to demonstrate that TCRP still outperformed established statistical and machine learning models in predicting drug responses in patient-derived tumor cells (PDTCs).\n\n2. **Performance Across Clinical Contexts**: The TCRP model was found to be superior in predicting drug responses across various clinical contexts, including both preclinical and clinical settings. This suggests that TCRP is a robust method for drug-response prediction.\n\n3. **Challenges in Reproducibility**: The study faced challenges in reproducing the original results, primarily due to the inability to extract data for all drugs investigated in the original publication. Only 32 out of 50 drugs could be recovered due to inconsistencies in gene names and missing reference files.\n\n4. **Hyperparameter Tuning**: The authors highlighted the importance of hyperparameter tuning for the TCRP model, noting that optimal hyperparameters varied significantly across different datasets. This tuning process was essential for achieving better predictive performance.\n\n5. **Reusability of TCRP**: The study demonstrated that TCRP could be effectively applied to new datasets, confirming its reusability. The model maintained its predictive capabilities when trained on different cell-line datasets, indicating its robustness.\n\n6. **Potential for Personalized Medicine**: The findings support the potential of the TCRP model to improve personalized medicine by facilitating the matching of patients' molecular profiles to optimal therapies, thereby enhancing treatment decision-making in precision oncology.\n\n7. **Recommendations for Future Research**: The authors suggested that improvements in the availability and sharing of the TCRP model, such as through containerized methods or interactive repositories, could enhance reproducibility and facilitate broader use in the scientific community.\n\nOverall, the paper underscores the importance of reproducibility and reusability in machine learning models for drug response prediction, while also highlighting the challenges and potential solutions in this area."
    },
    {
      "question": "How was the data analyzed in the study?",
      "answer": "In the study, the data analysis was conducted through a structured four-stage process aimed at reproducing and validating the performance of the Transfer of Cell Line Response Prediction (TCRP) model. Here\u2019s a detailed breakdown of the analysis process:\n\n1. **Data Extraction**: The first stage involved extracting gene expression and drug-response features from the GDSC1 dataset. The authors encountered challenges in this stage, as they could only extract input features for 32 out of 50 priority drugs due to missing reference files and inconsistencies in gene names.\n\n2. **Model Training**: In the second stage, the authors implemented the model-agnostic meta-learning (MAML) algorithm to train the drug response predictors. They faced difficulties in reproducing the deep neural network results because of the absence of complete baseline model implementations and had to reimplement the architecture based on the original paper's descriptions.\n\n3. **Fine-Tuning**: The third stage involved fine-tuning the models using a small subset of the patient-derived tumor cell (PDTC) dataset through few-shot learning. The authors conducted a brute-force search to optimize hyperparameters, testing various combinations to identify the best-performing parameters for each drug-tissue combination.\n\n4. **Validation**: The final stage was the validation of the trained models on the remaining PDTC samples. The authors compared the performance of their reimplemented TCRP model against established statistical and machine learning models. Although they confirmed the superiority of the TCRP model on average, they noted that their reimplementation did not achieve the same predictive value as the original publication.\n\nThroughout the analysis, the authors also emphasized the importance of hyperparameter tuning for each specific drug and validation dataset combination, as well as the need for proper data preprocessing to ensure reproducibility and reusability of the TCRP model in different contexts."
    },
    {
      "question": "Was the data in the study pre-processed in anyway? If so how?",
      "answer": "Yes, the data in the study was pre-processed in several ways. The pre-processing steps included:\n\n1. **Data Extraction**: The first stage involved extracting gene expression and drug-response features from the GDSC1 dataset. However, the authors faced challenges as they could only extract input features for 32 out of 50 priority drugs due to missing reference files and inconsistencies in gene names.\n\n2. **Hyperparameter Tuning**: In the second stage, the model-agnostic meta-learning (MAML) algorithm was trained to predict drug responses, which included hyperparameter tuning. The hyperparameters were crucial for optimizing the model's performance.\n\n3. **Fine-tuning**: In the third stage, the models were fine-tuned using a small subset of the patient-derived tumor cell (PDTC) dataset through few-shot learning. This involved a brute-force search to test various combinations of hyperparameters to find the best-performing set for each drug-tissue combination.\n\n4. **Validation**: The final stage involved validating the models on independent data, where the selected hyperparameters from the fine-tuning stage were used to run drug-specific models.\n\nAdditionally, the authors noted that proper preprocessing of the data was crucial for the model's application to other datasets, emphasizing the importance of resolving inconsistencies in gene names and ensuring accurate feature extraction."
    },
    {
      "question": "What conclusions were drawn in the paper?",
      "answer": "The conclusions drawn in the paper indicate that the Transfer of Cell Line Response Prediction (TCRP) model is a robust method for predicting drug response in both preclinical and clinical settings. The authors confirmed the superiority of TCRP over established statistical and machine learning approaches, although they noted that their reproducibility results did not reach the same level of performance as the original authors. Nonetheless, TCRP consistently outperformed baseline models in various contexts, including patient-derived tumor cells and clinical trial datasets.\n\nThe study also highlighted the importance of hyperparameter tuning for the TCRP model, as different datasets required unique configurations for optimal performance. The authors emphasized the need for improved resources and guidelines to enhance the reusability of the TCRP model, suggesting that better sharing of code and data preprocessing methods could facilitate its application in future research.\n\nOverall, the findings support the potential of TCRP to enhance personalized medicine by effectively matching patients' molecular profiles to appropriate therapies, thereby contributing to advancements in precision oncology."
    },
    {
      "question": "Can you provide a summary of the literature review from the paper?",
      "answer": "The literature review in the paper discusses the increasing application of machine learning (ML) and artificial intelligence (AI) in personalized medicine, particularly in precision oncology. It highlights the work of Ma et al. (2021), who introduced the transfer of cell line response prediction (TCRP) method, which utilizes few-shot learning to enhance drug response predictions based on cancer cell line data. The review emphasizes the significance of TCRP in aiding clinical treatment decisions and the necessity for independent validation of its effectiveness across diverse clinical contexts.\n\nThe authors note the challenges associated with translating predictors trained on preclinical data to clinical settings, citing limitations such as the absence of tumor microenvironment components in cell lines and differences in evolutionary pressures between human physiology and cell cultures. They underscore the importance of developing computational models that can accurately predict therapy responses in patients, given the difficulties in obtaining large clinical genomic datasets for multivariable analysis.\n\nThe literature review also mentions the need for improved reproducibility and reusability of predictive models like TCRP, as well as the potential benefits of these models in matching patients' molecular profiles to optimal therapies. The authors aim to confirm the performance of TCRP and expand its application to a broader range of preclinical and clinical datasets, thereby addressing the challenges of drug-response prediction in precision oncology."
    },
    {
      "question": "What future research directions do the authors suggest in the paper?",
      "answer": "The authors suggest several future research directions in the paper:\n\n1. **Improvement of Model Reusability**: They emphasize the need for developing new resources to enhance the reusability of the TCRP model for future improvements and validation studies. This includes making the model more accessible and easier to implement in various contexts.\n\n2. **Translation of Predictors**: The authors highlight the ongoing challenge of translating predictors trained on preclinical data to achieve good accuracy on clinical data. They suggest that successful translation could significantly improve personalized medicine by matching patients' molecular profiles to optimal therapies.\n\n3. **Exploration of Diverse Contexts**: They propose further investigation into the performance of the TCRP model across a broader range of preclinical and clinical datasets, particularly those that were not explored in the original publication. This includes assessing the model's predictive value in different cancer types and treatment scenarios.\n\n4. **Hyperparameter Optimization**: The authors note the necessity of retuning hyperparameters for the TCRP model whenever new datasets are introduced. Future research could focus on developing more efficient methods for hyperparameter tuning to enhance model performance across various datasets.\n\n5. **Integration of Computational Technologies**: They suggest leveraging recent advances in molecular profiling and computational technologies to further enhance the capabilities of machine learning and AI methods in personalized medicine and precision oncology.\n\n6. **Containerized Methods**: The authors recommend presenting the few-shot learning model in a containerized format, such as a Python package or an interactive repository, to facilitate easier sharing and execution by other researchers.\n\nThese directions aim to address the limitations encountered during the study and to enhance the applicability and effectiveness of the TCRP model in clinical settings."
    },
    {
      "question": "What statistical techniques were used in the paper?",
      "answer": "The paper utilized several statistical techniques, primarily focusing on machine learning and predictive modeling approaches. The key statistical techniques mentioned include:\n\n1. **Pearson Correlation**: This was used to evaluate the predictive performance of the TCRP model compared to baseline methods. The authors reported Pearson correlation values to assess the relationship between predicted drug responses and actual responses.\n\n2. **Spearman Correlation**: In addition to Pearson correlation, Spearman correlation was also employed to compare the performance of the TCRP model against baseline methods. This technique was noted to yield slightly lower correlation values compared to Pearson correlation.\n\n3. **Model-Agnostic Meta-Learning (MAML)**: This algorithm was used for training drug response predictors, allowing the model to learn from a limited number of samples (few-shot learning).\n\n4. **Hyperparameter Tuning**: The study involved a brute-force search for optimal hyperparameters, which included adjusting learning rates and the number of hidden neurons in the models.\n\n5. **Statistical Baseline Models**: The paper compared the TCRP model against established statistical and machine learning models, including:\n   - **Linear Regression**\n   - **Random Forest**\n   - **K-Nearest Neighbors (KNN)**\n   - **Neural Networks**\n\nThese techniques were employed to validate the performance of the TCRP model in predicting drug responses across various datasets, including preclinical and clinical contexts."
    },
    {
      "question": "Can you describe the experimental setup in the paper?",
      "answer": "The experimental setup described in the paper involves several key stages aimed at reproducing and validating the performance of the Transfer of Cell Line Response Prediction (TCRP) model for predicting drug response in cancer patient samples. Here\u2019s a detailed breakdown of the experimental setup:\n\n1. **Data Extraction (Stage 1)**: The researchers began by extracting drug-response data from the GDSC1 dataset, which contains information on immortalized cancer cell lines. They aimed to identify common drug features between the GDSC1 dataset and the patient-derived tumor cell (PDTC) dataset. However, they encountered challenges, as they could only extract features for 32 out of the 50 priority drugs due to inconsistencies in gene names and missing reference files.\n\n2. **Model Training (Stage 2)**: The TCRP model was trained using a model-agnostic meta-learning (MAML) algorithm. The researchers implemented the MAML architecture, which included a linear layer, ReLU activation, and batch normalization. They faced difficulties reproducing the original deep neural network results due to the absence of specific baseline model implementations.\n\n3. **Fine-Tuning (Stage 3)**: The researchers fine-tuned the TCRP model using a few-shot learning approach. They conducted a brute-force search to optimize hyperparameters, including the number of few-shot samples, learning rates, and the number of hidden neurons. This process was computationally intensive, as they tested all combinations of hyperparameters for each drug and tissue combination.\n\n4. **Validation (Stage 4)**: After selecting the optimal hyperparameters, the researchers validated the TCRP model on independent PDTC data. They compared the performance of the TCRP model against baseline models (linear regression, random forest, and nearest neighbor) using Pearson correlation coefficients to assess predictive accuracy.\n\n5. **Reusability Assessment**: The researchers also tested the TCRP model's performance on various datasets beyond the original study, including different cell-line datasets (CTRP, gCSI, GDSC2) and clinical trial data. They evaluated the model's ability to predict drug responses across different contexts, including in vitro and in vivo settings, and adjusted the model as necessary for each new dataset.\n\n6. **Performance Metrics**: Throughout the experiments, the researchers measured the predictive performance of the TCRP model using Pearson and Spearman correlation coefficients, comparing the predicted drug responses to actual responses across various datasets.\n\nOverall, the experimental setup was comprehensive, involving multiple stages of data extraction, model training, fine-tuning, and validation, with a focus on ensuring reproducibility and assessing the model's applicability to new clinical contexts."
    },
    {
      "question": "What are the implications of the research findings?",
      "answer": "The research findings of the paper have several important implications for the field of personalized medicine and precision oncology:\n\n1. **Validation of TCRP Method**: The study confirms the effectiveness of the Transfer of Cell Line Response Prediction (TCRP) method in predicting drug responses in cancer patients, supporting its use as a reliable tool for clinicians in treatment decision-making. This validation enhances confidence in using TCRP for real-world applications.\n\n2. **Reusability Across Contexts**: The findings demonstrate that TCRP can be successfully applied to various clinical and preclinical datasets, indicating its robustness and versatility. This suggests that TCRP can be adapted for different cancer types and treatment scenarios, potentially leading to broader applications in oncology.\n\n3. **Improvement of Drug Response Predictions**: The superior performance of TCRP over traditional statistical and machine learning methods in predicting drug responses highlights its potential to enhance the accuracy of personalized treatment plans. This could lead to better patient outcomes by matching therapies more effectively to individual molecular profiles.\n\n4. **Challenges in Reproducibility**: The study also underscores the challenges associated with reproducing results in computational biology, such as discrepancies in dataset features and hyperparameter tuning. Addressing these challenges is crucial for ensuring that predictive models can be reliably utilized in clinical settings.\n\n5. **Resource Development for Future Research**: The authors developed new resources to improve the reusability of the TCRP model, which can facilitate future research and validation studies. This commitment to resource sharing promotes collaboration and accelerates advancements in the field.\n\n6. **Encouragement for Further Research**: The findings encourage further exploration of machine learning methods in drug response prediction, particularly in the context of integrating molecular profiling and computational technologies. This could lead to the development of even more sophisticated models that enhance the precision of cancer treatments.\n\n7. **Impact on Clinical Trials**: The ability of TCRP to predict drug responses in clinical trial datasets suggests that it could play a significant role in the design and evaluation of new cancer therapies, potentially streamlining the drug development process.\n\nOverall, the implications of this research extend beyond the immediate findings, offering pathways for improving cancer treatment strategies and enhancing the reproducibility and applicability of machine learning models in clinical practice."
    },
    {
      "question": "What are the limitations and delimitations mentioned in the paper?",
      "answer": "The paper discusses several limitations and delimitations related to the reproducibility and reusability of the TCRP (transfer of cell line response prediction) model for predicting drug response in cancer patient samples. Here are the key points:\n\n### Limitations:\n1. **Limited Drug Recovery**: The authors were only able to recover drug-response data for 32 out of the 50 drugs originally investigated due to missing reference files and inconsistencies in gene names. This limited the scope of their analysis and the ability to fully replicate the original study's findings.\n\n2. **Hyperparameter Tuning Challenges**: The process of tuning hyperparameters for the TCRP model was complex and required unique adjustments for each specific drug and validation dataset combination. This made it difficult to achieve the same predictive performance as reported in the original publication.\n\n3. **Incomplete Baseline Model Implementation**: The original authors did not provide a complete implementation of the baseline models, particularly the neural network architecture, which necessitated the authors to reimplement it themselves. This could introduce variability and affect reproducibility.\n\n4. **Variability in Predictive Performance**: The reimplemented TCRP model did not achieve the same level of predictive value as the original model, with a maximum Pearson correlation of 0.2 compared to over 0.3 in the original publication. This indicates potential issues with the model's performance across different datasets.\n\n5. **Dependence on Dataset Quality**: The performance of the TCRP model varied significantly depending on the choice of training data, suggesting that the quality and characteristics of the datasets used can greatly influence the model's predictive capabilities.\n\n### Delimitations:\n1. **Focus on Specific Datasets**: The study primarily utilized datasets from the GDSC1 and PDTC, which may limit the generalizability of the findings to other datasets or contexts not explored in the paper.\n\n2. **Drug Response Measurement Variability**: The authors acknowledged challenges in aligning drug response measurements across different experimental settings (in vitro vs. in vivo vs. clinical trials), which could affect the applicability of the TCRP model across diverse scenarios.\n\n3. **Modeling Approach**: The study specifically focused on the TCRP model and its application to drug response prediction, which may exclude other potentially relevant modeling approaches or methodologies that could also contribute to advancements in precision oncology.\n\nOverall, while the study successfully confirmed the superiority of the TCRP model in certain contexts, the limitations and delimitations highlight the complexities involved in reproducing and reusing predictive models in the field of personalized medicine."
    },
    {
      "question": "What recommendations do the authors make in the paper?",
      "answer": "The authors of the paper make several recommendations aimed at improving the reproducibility and reusability of the Transfer of Cell Line Response Prediction (TCRP) model for predicting drug responses in cancer treatments. Here are the key recommendations:\n\n1. **Enhance Model Sharing**: The authors suggest that the TCRP model should be implemented in a manner that is easily shareable and executable. This includes using platforms like Code Ocean to facilitate straightforward sharing and execution by other researchers.\n\n2. **Improve Data Preprocessing**: Proper preprocessing of data is emphasized as crucial for the model's application to other datasets. The authors recommend ensuring that datasets are curated with detailed versioning and unique digital object identifiers (DOIs) to maintain transparency and reproducibility.\n\n3. **Provide Comprehensive Documentation**: The authors highlight the need for better documentation, including reference files or instructions to resolve inconsistencies in gene names and drug targets. This would help in recovering more drugs for analysis.\n\n4. **Hyperparameter Tuning**: The authors note that hyperparameters must be uniquely adjusted for each specific drug and validation dataset combination. They recommend that future implementations include clear guidelines for hyperparameter tuning to enhance model performance.\n\n5. **Containerized Methods**: The authors propose that methods like the few-shot model should be presented in a containerized fashion, either as a Python package or in an interactive containerized repository, to facilitate easier access and use by the scientific community.\n\n6. **Address Limitations in Drug Recovery**: The authors discuss the challenges faced in recovering drug-response data and suggest that future studies should aim to improve the recovery of drug features common to different datasets.\n\nBy following these recommendations, the authors believe that the TCRP model can be more effectively utilized in various clinical and preclinical contexts, ultimately enhancing its impact on personalized medicine and precision oncology."
    },
    {
      "question": "Who funded the research in the paper?",
      "answer": "The research in the paper was funded by the Canadian Cancer Society Data Transformations (grant number 707609) and by a Natural Sciences and Engineering Research Council of Canada Discovery Grant (RGPIN-2021-02680)."
    },
    {
      "question": "Is there any conflict of interest disclosed in the paper?",
      "answer": "Yes, there are conflicts of interest disclosed in the paper. Specifically, it is mentioned that Benjamin Haibe-Kains (B.H.-K.) is a shareholder and paid consultant for Code Ocean Inc., and Emily So (E.S.) is also a paid consultant for Code Ocean Inc. The remaining authors declare no competing interests."
    },
    {
      "question": "What ethical considerations are discussed in the paper?",
      "answer": "The paper discusses several ethical considerations related to the use of machine learning (ML) and artificial intelligence (AI) in personalized medicine and precision oncology. Key ethical points include:\n\n1. **Reproducibility and Transparency**: The authors emphasize the importance of reproducibility in research, particularly in the context of ML models used for predicting drug responses. They highlight that the ability to replicate results is crucial for building trust in computational models that influence clinical decisions. The paper advocates for clear sharing of methodologies, datasets, and code to facilitate reproducibility.\n\n2. **Data Integrity and Quality**: The paper notes challenges in obtaining high-quality clinical genomic data, which is essential for training accurate predictive models. Ethical implications arise from the potential consequences of using flawed or incomplete data, which could lead to incorrect treatment recommendations for patients.\n\n3. **Patient Safety and Treatment Decisions**: Given that the TCRP model is intended to assist clinicians in making treatment decisions, the ethical responsibility to ensure that the model is reliable and valid is paramount. Inaccurate predictions could adversely affect patient outcomes, raising ethical concerns about the deployment of such models in clinical settings.\n\n4. **Equity and Access**: The authors discuss the need for equitable access to the resources and technologies that enable the use of ML in medicine. There is an ethical imperative to ensure that advancements in precision oncology benefit all patient populations, not just those with access to cutting-edge technologies.\n\n5. **Informed Consent and Patient Privacy**: The paper implicitly touches on the ethical considerations surrounding patient data usage, including the need for informed consent when utilizing patient-derived data for research and model training. Protecting patient privacy while leveraging data for predictive modeling is a critical ethical concern.\n\n6. **Potential for Bias**: The authors acknowledge that biases in training data can lead to biased predictions, which can disproportionately affect certain patient groups. Addressing these biases is essential to ensure fair treatment recommendations across diverse populations.\n\nOverall, the paper underscores the ethical responsibilities of researchers and clinicians in the development and application of AI and ML in healthcare, particularly in ensuring that these technologies are used safely, transparently, and equitably."
    },
    {
      "question": "Which studies are most frequently cited in the paper?",
      "answer": "The most frequently cited study in the paper is by Ma et al. (2021), which introduced the method called transfer of cell line response prediction (TCRP). This study is referenced multiple times throughout the paper, highlighting its significance in the context of drug response prediction in cancer patient samples. Other studies mentioned include those related to the Genomics of Drug Sensitivity in Cancer (GDSC) and various methodologies for evaluating drug response, but Ma et al. (2021) is the primary focus of the citations."
    },
    {
      "question": "Can you explain the technical terms used in the paper?",
      "answer": "Certainly! Here are explanations for some of the technical terms used in the paper:\n\n1. **Reproducibility**: This refers to the ability to obtain consistent results using the same methods and data as a previous study. In the context of this paper, it involves verifying whether the findings of the original study on the TCRP model can be replicated.\n\n2. **Reusability**: This term indicates how well a model or method can be applied to new datasets or contexts beyond those it was originally trained on. The paper discusses efforts to enhance the TCRP model's applicability to various clinical and preclinical scenarios.\n\n3. **TCRP (Transfer of Cell Line Response Prediction)**: This is a machine learning method developed to predict drug responses in cancer treatment by transferring knowledge gained from cancer cell lines to more complex models, such as patient-derived tumor cells.\n\n4. **Few-shot learning**: A type of machine learning where the model is trained on a very small number of examples (shots) to make predictions. This is particularly useful in scenarios where data is scarce, such as in clinical settings.\n\n5. **Drug-response predictors**: These are computational models designed to forecast how cancer patients will respond to specific drugs based on their genetic and molecular profiles.\n\n6. **Preclinical pharmacogenomic data**: This refers to data derived from laboratory studies (often using cell lines) that investigate how genetic variations affect responses to drugs before moving to clinical trials.\n\n7. **Patient-derived tumor cells (PDTCs)**: These are cancer cells taken directly from patients and cultured in the lab. They are used to study drug responses in a setting that more closely resembles the actual tumor environment compared to traditional cell lines.\n\n8. **Pearson correlation**: A statistical measure that assesses the linear relationship between two continuous variables. In this paper, it is used to evaluate the predictive performance of the TCRP model against actual drug responses.\n\n9. **Spearman correlation**: A non-parametric measure of rank correlation that assesses how well the relationship between two variables can be described using a monotonic function. It is often used when the data does not meet the assumptions required for Pearson correlation.\n\n10. **Hyperparameter tuning**: The process of optimizing the parameters that govern the training of a machine learning model (e.g., learning rate, number of layers) to improve its performance.\n\n11. **Model-agnostic meta-learning (MAML)**: A machine learning technique that enables models to learn quickly from a small amount of data by training them on a variety of tasks.\n\n12. **Drug dose-response curves**: Graphical representations that show the relationship between the dose of a drug and the magnitude of its effect on a biological system, often used to determine the efficacy of a drug.\n\n13. **Response Evaluation Criteria in Solid Tumors (RECIST)**: A set of standardized criteria used to assess how well a cancer treatment is working based on changes in tumor size.\n\n14. **Binarization**: The process of converting continuous data into binary categories (e.g., responders vs. non-responders) for analysis.\n\n15. **Computational models**: Algorithms or simulations that use mathematical and statistical techniques to represent complex biological processes, such as drug responses in cancer treatment.\n\nThese terms are central to understanding the methodologies and findings discussed in the paper regarding the TCRP model and its applications in predicting drug responses in cancer therapy."
    },
    {
      "question": "What data sources were used in the paper, and are they accessible for further research?",
      "answer": "The paper utilized several data sources, primarily focusing on publicly available datasets for drug response prediction in cancer. The specific datasets mentioned include:\n\n1. **GDSC1 (Genomics of Drug Sensitivity in Cancer)** - This dataset contains information on drug responses in cancer cell lines.\n2. **PDTC (Patient-Derived Tumor Cells)** - This dataset includes patient-derived breast tumor cell responses.\n3. **CTRP (Cancer Therapeutics Response Portal)** - Another dataset used for training and validating the TCRP model.\n4. **gCSI (Genomic Cancer Sensitivity Information)** - This dataset was also utilized in the study.\n5. **Clinical trial datasets** - Specifically, GSE25066 and GSE41998 were mentioned as part of the validation process.\n\nAll these datasets are accessible for further research through the ORCESTRA platform, which provides curated datasets with detailed versioning and unique digital object identifiers (DOIs). The paper also mentions that the code used for analysis is available on GitHub and through a Code Ocean capsule, facilitating reproducibility and further exploration by other researchers."
    },
    {
      "question": "Can you summarize the research paper?",
      "answer": "The research paper titled \"Reusability report, Evaluating reproducibility and reusability of a fine-tuned model to predict drug response in cancer patient samples\" published in *Nature Machine Intelligence* in July 2023, investigates the reproducibility and reusability of a machine learning model known as Transfer of Cell Line Response Prediction (TCRP). This model, originally developed by Ma et al. in 2021, utilizes few-shot learning to predict drug responses in cancer cell lines and aims to enhance treatment decision-making in precision oncology.\n\nThe authors of this paper aimed to independently reproduce the findings of the original study and assess the model's applicability in new clinical contexts. Their results confirmed that while they could not replicate the exact performance metrics of the original TCRP model, they still demonstrated its superiority over traditional statistical and machine learning methods in predicting drug responses across various datasets, including patient-derived tumor cells (PDTCs).\n\nThe study highlighted challenges in the reproducibility process, such as difficulties in extracting drug-response data for all drugs due to inconsistencies in gene naming and the absence of complete instructions for model training and hyperparameter tuning. Despite these challenges, the authors successfully validated the TCRP model's predictive capabilities in multiple preclinical and clinical settings, indicating its robustness and potential for broader application in personalized medicine.\n\nAdditionally, the authors provided resources to enhance the reusability of the TCRP model, emphasizing the importance of making computational models accessible and executable for future research. Overall, the findings support the TCRP model as a valuable tool in precision oncology, capable of improving the matching of cancer patients to effective therapies based on their molecular profiles."
    },
    {
      "question": "What is the significance of this research in its field?",
      "answer": "The significance of this research lies in its contribution to the field of personalized medicine and precision oncology, particularly through the evaluation and enhancement of the Transfer of Cell Line Response Prediction (TCRP) model. This study independently reproduces the findings of the original TCRP model, confirming its effectiveness in predicting drug responses in cancer treatment and demonstrating its superiority over traditional statistical and machine learning methods in both preclinical and clinical settings.\n\nKey points of significance include:\n\n1. **Validation of TCRP**: The research confirms the TCRP model's predictive capabilities, supporting its use in clinical contexts where accurate drug-response predictions are crucial for treatment decisions.\n\n2. **Reusability and Adaptability**: By assessing the model's performance across various datasets, the study highlights the TCRP model's robustness and adaptability to different clinical scenarios, which is essential for its application in real-world settings.\n\n3. **Advancement of Machine Learning in Oncology**: The findings underscore the potential of machine learning techniques, specifically few-shot learning, to enhance the precision of drug-response predictions, thereby improving patient outcomes in cancer therapy.\n\n4. **Resource Development**: The authors created new resources to facilitate the reusability of the TCRP model, which can aid future research and validation studies, promoting transparency and reproducibility in computational oncology.\n\n5. **Addressing Challenges in Translational Research**: The study discusses the challenges of translating preclinical findings to clinical applications, providing insights into the complexities of drug-response prediction and the importance of model tuning for different datasets.\n\nOverall, this research not only reinforces the TCRP model's validity but also contributes to the broader goal of integrating advanced computational methods into personalized cancer treatment, ultimately aiming to optimize therapeutic strategies based on individual patient profiles."
    },
    {
      "question": "How does this paper contribute to the existing body of knowledge?",
      "answer": "The paper titled \"Evaluating reproducibility and reusability of a fine-tuned model to predict drug response in cancer patient samples\" contributes to the existing body of knowledge in several significant ways:\n\n1. **Reproducibility of TCRP Model**: The study independently reproduces the findings of the original TCRP (Transfer of Cell Line Response Prediction) model developed by Ma et al. This is crucial as reproducibility is a cornerstone of scientific research, ensuring that results can be verified and trusted. The authors confirmed that while they did not achieve the same level of predictive performance as the original study, they were able to validate the superiority of the TCRP model in its original clinical context.\n\n2. **Assessment of Reusability**: The paper expands on the concept of reusability by applying the TCRP model to a broader range of clinical and preclinical datasets. This demonstrates the model's robustness and adaptability across different contexts, which is essential for its practical application in precision oncology.\n\n3. **Comparison with Established Methods**: The authors provide a comparative analysis of the TCRP model against established statistical and machine learning methods. Their results indicate that TCRP consistently outperforms these baseline models, reinforcing its potential as a superior tool for predicting drug responses in cancer treatment.\n\n4. **Development of Resources for Future Research**: The study also emphasizes the importance of making computational models more accessible and reusable. The authors developed new resources and provided detailed methodologies for implementing the TCRP model, which can facilitate further research and validation studies by other scientists.\n\n5. **Addressing Challenges in Drug Response Prediction**: The paper discusses the challenges faced in translating predictors trained on preclinical data to clinical settings, highlighting the complexities involved in drug response prediction. By addressing these challenges, the authors contribute valuable insights into the limitations and considerations necessary for effective model application in real-world scenarios.\n\n6. **Integration of Machine Learning in Personalized Medicine**: By showcasing the application of machine learning techniques in predicting drug responses, the paper contributes to the growing field of personalized medicine. It underscores the potential of AI and machine learning to enhance treatment decision-making processes in oncology.\n\nOverall, this paper not only validates and extends the findings of the original TCRP model but also provides a framework for its application in diverse clinical contexts, thereby enhancing the understanding and utility of machine learning in cancer treatment."
    },
    {
      "question": "Are there any novel techniques or approaches introduced in this paper?",
      "answer": "Yes, the paper introduces a novel technique called the \"transfer of cell line response prediction\" (TCRP). This method utilizes few-shot learning to train predictors of drug response based on data from cancer cell lines, allowing for the optimization of these predictors in more complex cancer model systems. The authors aimed to independently reproduce the findings of the original TCRP study and enhance its reusability across various clinical contexts. They confirmed the superiority of TCRP in predicting drug responses compared to established statistical and machine learning methods, thereby supporting its application in personalized medicine and precision oncology. Additionally, the paper discusses the development of new resources to improve the reusability of the TCRP model for future studies."
    },
    {
      "question": "What are the potential real-world applications of this research?",
      "answer": "The research paper discusses the transfer of cell line response prediction (TCRP) model, which utilizes machine learning and artificial intelligence to predict drug responses in cancer treatment. The potential real-world applications of this research include:\n\n1. **Personalized Medicine**: The TCRP model can facilitate the matching of a patient's molecular profile to optimal therapies, enhancing personalized treatment plans in oncology.\n\n2. **Improved Drug Response Prediction**: By accurately predicting how different cancer patients will respond to various drugs, the TCRP model can help clinicians make better-informed treatment decisions, potentially leading to improved patient outcomes.\n\n3. **Clinical Trials**: The model's ability to predict drug responses in complex clinical settings, including patient-derived xenografts and clinical trial datasets, suggests its utility in designing and evaluating new cancer therapies.\n\n4. **Integration with Molecular Profiling**: As molecular profiling technologies advance, the TCRP model can be integrated into clinical workflows to assess the efficacy of treatments based on individual genetic and molecular characteristics.\n\n5. **Resource Development for Future Studies**: The research also emphasizes the creation of resources to enhance the reusability of the TCRP model, which can be beneficial for future validation studies and improvements in predictive modeling.\n\n6. **Broader Application Across Cancer Types**: The findings indicate that the TCRP model can be adapted for various cancer types, making it a versatile tool in oncology.\n\nOverall, the TCRP model represents a significant advancement in the field of precision oncology, with the potential to transform how cancer treatments are selected and personalized for patients."
    },
    {
      "question": "How does the paper address potential biases in the research?",
      "answer": "The paper addresses potential biases in the research through several key strategies:\n\n1. **Reproducibility and Validation**: The authors aimed to independently reproduce the findings of the original TCRP model by using the same datasets and methodologies. They acknowledged that their reproducibility results did not reach the same level of performance as the original study but confirmed the model's superiority in the original clinical context. This approach helps to identify any discrepancies that may arise from different implementations or datasets.\n\n2. **Dataset Limitations**: The authors noted challenges related to the limited number of drugs they could recover from the reference datasets, which could introduce bias in the predictive performance. They highlighted that only 32 out of 50 drugs were successfully recovered, indicating that dataset inconsistencies could affect the results.\n\n3. **Hyperparameter Tuning**: The paper discusses the necessity of retuning hyperparameters for the TCRP model when applied to new datasets. This emphasizes the importance of ensuring that the model is appropriately calibrated for each specific context, which can mitigate biases arising from inappropriate model configurations.\n\n4. **Diverse Testing Contexts**: The authors tested the TCRP model across various preclinical and clinical datasets, including patient-derived xenografts and clinical trials. This broad application helps to assess the model's robustness and generalizability, reducing the risk of biases that could occur if the model were only validated in a narrow context.\n\n5. **Transparency and Resource Sharing**: The authors made their code and datasets publicly available, which promotes transparency and allows other researchers to verify and build upon their work. This openness can help identify and correct potential biases in the methodology or data processing.\n\n6. **Discussion of Limitations**: The paper includes a discussion of the limitations encountered during the reproducibility process, such as missing data and inconsistencies in gene names. By openly addressing these issues, the authors acknowledge potential sources of bias and the need for careful data handling.\n\nOverall, the paper emphasizes the importance of reproducibility, careful dataset management, and transparency to address and mitigate potential biases in the research."
    },
    {
      "question": "What validation methods were used to ensure the reliability of the results?",
      "answer": "The validation methods used in the study to ensure the reliability of the results included several key approaches:\n\n1. **Reproducibility Testing**: The authors aimed to independently reproduce the findings of the original TCRP model by following a structured four-stage process:\n   - **Stage 1**: Extracting gene expression and drug-response features from the GDSC1 dataset.\n   - **Stage 2**: Training the model-agnostic meta-learning (MAML) algorithm to predict drug response and performing hyperparameter tuning.\n   - **Stage 3**: Fine-tuning the models using a small subset of the patient-derived tumor cell (PDTC) dataset through few-shot learning.\n   - **Stage 4**: Validating the model on the remaining PDTC samples.\n\n2. **Comparison with Baseline Models**: The performance of the TCRP model was compared against established statistical and machine learning models (such as linear regression, random forest, and nearest neighbor) to assess its predictive value.\n\n3. **Hyperparameter Tuning**: The authors conducted a brute-force search to optimize hyperparameters for the TCRP model, ensuring that the best-performing parameters were selected for each drug-tissue combination.\n\n4. **Use of Multiple Datasets**: The TCRP model was tested across various datasets, including different cell-line datasets (CTRP, gCSI, GDSC2) and clinical trial data, to evaluate its robustness and transferability.\n\n5. **Statistical Analysis**: Performance metrics such as Pearson and Spearman correlation coefficients were used to quantify the predictive accuracy of the models, providing a statistical basis for comparing the results.\n\n6. **Data Availability and Transparency**: The datasets used in the study were made available through the ORCESTRA platform, ensuring transparency and reproducibility of the data processing and analysis.\n\n7. **Code Availability**: The authors provided access to the code used for their analyses via a Code Ocean capsule and GitHub, facilitating replication of their work by other researchers.\n\nThese methods collectively contributed to validating the reliability of the results and confirming the predictive capabilities of the TCRP model in various contexts."
    },
    {
      "question": "Are there any contradictions between this paper's findings and previous research?",
      "answer": "Yes, there are contradictions between the findings of this paper and previous research, particularly regarding the performance of the TCRP model compared to baseline methods. \n\n1. **Performance Discrepancies**: The original study by Ma et al. (2021) reported that the TCRP model outperformed established statistical and machine learning models, achieving a Pearson correlation of over 0.3 in predicting drug responses. In contrast, the current paper's reimplementation of the TCRP model only reached a peak predictive value of 0.2, indicating a lower performance than originally reported. This suggests a contradiction in the effectiveness of the TCRP model when reproduced under similar conditions.\n\n2. **Baseline Model Performance**: The current study found that a simple linear regression model performed better than the TCRP model in their reanalysis, which contradicts the original findings that positioned TCRP as superior to all baseline methods. This raises questions about the robustness of the TCRP model's performance across different datasets and conditions.\n\n3. **Drug-Specific Variability**: The reimplementation also revealed significant variability in correlation values for specific drugs, such as sorafenib and MK-2206, which had lower correlation values in the current study compared to the original publication. This inconsistency highlights potential issues in the reproducibility of the TCRP model's predictions.\n\nOverall, while the current study confirms some aspects of TCRP's superiority in certain contexts, it also presents evidence that challenges the original claims of its performance, indicating contradictions with previous research findings."
    }
  ]
}